<!-- Project Catalog Template -->

<section class="projects-section">
    <?php
    // Page Header
    $header = new PageHeader([
        'title' => $lang['projects_title']
    ]);
    echo $header->render();
    
    // Filter Bar
    $filters = [
        [
            'type' => 'select',
            'id' => 'filter-domain',
            'name' => 'domain',
            'label' => $lang['filter_by_domain'] ?? 'Filtrer par domaine',
            'options' => $domains ?? []
        ],
        [
            'type' => 'select',
            'id' => 'filter-status',
            'name' => 'status',
            'label' => $lang['filter_by_status'] ?? 'Filtrer par statut',
            'options' => array_map(function($status) use ($lang) {
                $statusKey = 'status_' . str_replace(' ', '_', $status);
                return [
                    'value' => $status,
                    'text' => $lang[$statusKey] ?? $status
                ];
            }, $statuses ?? [])
        ],
        [
            'type' => 'select',
            'id' => 'filter-supervisor',
            'name' => 'supervisor',
            'label' => 'Filtrer par responsable',
            'options' => array_map(function($sup) {
                return [
                    'value' => $sup['id_user'],
                    'text' => $sup['prenom'] . ' ' . $sup['nom']
                ];
            }, $supervisors ?? [])
        ]
    ];
    
    $filterBar = new FilterBar([
        'filters' => $filters,
        'lang' => $lang,
        'showResetButton' => true
    ]);
    echo $filterBar->render();
    
    // Project Grid
    $projectGrid = new ProjectGrid([
        'projects' => $projects ?? [],
        'lang' => $lang,
        'baseUrl' => BASE_URL
    ]);
    echo $projectGrid->render();
    ?>
</section>
